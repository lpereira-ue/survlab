<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>survlab • survlab</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="survlab">
<meta name="description" content="Survival-model-based imputation for censored laboratory measurements in environmental and laboratory data.">
<meta property="og:description" content="Survival-model-based imputation for censored laboratory measurements in environmental and laboratory data.">
<meta property="og:image" content="https://lpereira-ue.github.io/survlab/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">survlab</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lpereira-ue/survlab"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p># survlab <a href="https://lpereira-ue.github.io/survlab/"><img src="reference/figures/logo.png" align="right" height="120" alt="survlab website"></a></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>survlab</code> provides functions for imputing non-detect values in environmental laboratory data using survival models (including Tobit models) with automatic distribution selection. Is designed specifically for working with analytical data where measurements fall below detection limits or limits of quantification (LOQ).</p>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<ul>
<li>
<strong>Automatic distribution selection</strong>: Tests multiple distributions (gaussian, lognormal, weibull, exponential, logistic, log-logistic) and selects the best fit based on AIC</li>
<li>
<strong>Data quality validation</strong>: Ensures sufficient sample size (≥25) and reasonable censoring percentage (≤75%)</li>
<li>
<strong>Parameter/unit validation</strong>: Validates data consistency for single parameter datasets</li>
<li>
<strong>Individual detection limit handling</strong>: Each non-detect observation can have its own detection limit</li>
<li>
<strong>Realistic imputation</strong>: Generates unique random values below their respective detection limits</li>
<li>
<strong>Built-in validation</strong>: Comprehensive validation and diagnostic tools designed for laboratory data</li>
<li>
<strong>Efficient implementation</strong>: Uses <code>data.table</code> for fast and memory-efficient operations</li>
<li>
<strong>Environmental focus</strong>: Designed specifically for environmental monitoring and contamination assessment data</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">survlab</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">survlab</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load example environmental data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">multi_censored_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Explore the data</span></span>
<span><span class="va">multi_censored_data</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  total_samples <span class="op">=</span> <span class="va">.N</span>,</span>
<span>  non_detects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,  <span class="co"># 0 = non-detect (below detection limit)</span></span>
<span>  detects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>       <span class="co"># 1 = detected (above detection limit)</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Perform imputation with parameter validation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/impute_nondetect.html">impute_nondetect</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">multi_censored_data</span>,</span>
<span>  value_col <span class="op">=</span> <span class="st">"value"</span>, </span>
<span>  cens_col <span class="op">=</span> <span class="st">"censored"</span>,</span>
<span>  parameter_col <span class="op">=</span> <span class="st">"parameter"</span>,</span>
<span>  unit_col <span class="op">=</span> <span class="st">"unit"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Validate results</span></span>
<span><span class="fu"><a href="reference/validate_imputation.html">validate_imputation</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View imputed values</span></span>
<span><span class="va">result</span><span class="op">[</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  original_detection_limit <span class="op">=</span> <span class="va">value</span>,</span>
<span>  imputed_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value_imputed</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  final_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value_final</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-structure">Data Structure<a class="anchor" aria-label="anchor" href="#data-structure"></a>
</h2>
<p>The package expects laboratory data with the following structure:</p>
<ul>
<li>
<strong>value_col</strong>: Contains either detected values (for samples above detection limit) or detection limit values (for non-detect samples)</li>
<li>
<strong>cens_col</strong>: Binary indicator where <code>0 = non-detect</code> (below detection limit), <code>1 = detected</code> (above detection limit)</li>
<li>
<strong>parameter_col</strong> (optional): Parameter name (e.g., “Nitrate”, “Lead”, “pH”)</li>
<li>
<strong>unit_col</strong> (optional): Unit of measurement (e.g., “mg/L”, “ug/L”, “pH units”)</li>
</ul>
<p>For non-detect observations, the value in <code>value_col</code> is treated as the detection limit for that specific analysis. The package validates that only one parameter and one unit are present when these columns are provided.</p>
</div>
<div class="section level2">
<h2 id="main-functions">Main Functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<div class="section level3">
<h3 id="impute_nondetect">
<code>impute_nondetect()</code><a class="anchor" aria-label="anchor" href="#impute_nondetect"></a>
</h3>
<p>The main imputation function that: - Validates data quality (sample size ≥25, censoring ≤75%) - Ensures parameter and unit consistency - Fits multiple survival models with different distributions - Selects the best model based on AIC - Generates random imputed values below each observation’s detection limit - Returns original data with additional imputed value columns</p>
</div>
<div class="section level3">
<h3 id="validate_imputation">
<code>validate_imputation()</code><a class="anchor" aria-label="anchor" href="#validate_imputation"></a>
</h3>
<p>Validation function that checks: - All imputed values are below their respective detection limits - Uniqueness of imputed values - Summary statistics by detection limit level - Model fit information</p>
</div>
</div>
<div class="section level2">
<h2 id="example-output">Example Output<a class="anchor" aria-label="anchor" href="#example-output"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># After imputation, the data includes new columns:</span></span>
<span><span class="co"># - value_imputed: Imputed values for non-detect observations</span></span>
<span><span class="co"># - value_final: Combined detected and imputed values</span></span>
<span></span>
<span><span class="co"># Model information is stored as attributes:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"best_distribution"</span><span class="op">)</span>    <span class="co"># Best-fitting distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"aic"</span><span class="op">)</span>                 <span class="co"># Model AIC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"parameter"</span><span class="op">)</span>           <span class="co"># Parameter name</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"unit"</span><span class="op">)</span>                <span class="co"># Unit of measurement</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"sample_size"</span><span class="op">)</span>         <span class="co"># Total observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"censored_pct"</span><span class="op">)</span>        <span class="co"># Percentage censored</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"detection_limits"</span><span class="op">)</span>    <span class="co"># All detection limits found</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"max_detection_limit"</span><span class="op">)</span> <span class="co"># Highest detection limit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"best_model"</span><span class="op">)</span>          <span class="co"># Fitted survival model</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced-usage">Advanced Usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h2>
<div class="section level3">
<h3 id="custom-validation-thresholds">Custom Validation Thresholds<a class="anchor" aria-label="anchor" href="#custom-validation-thresholds"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adjust validation criteria</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/impute_nondetect.html">impute_nondetect</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">data</span>,</span>
<span>  min_observations <span class="op">=</span> <span class="fl">50</span>,     <span class="co"># Require at least 50 observations</span></span>
<span>  max_censored_pct <span class="op">=</span> <span class="fl">60</span>      <span class="co"># Allow up to 60% censoring</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="custom-distribution-selection">Custom Distribution Selection<a class="anchor" aria-label="anchor" href="#custom-distribution-selection"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test only specific distributions</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/impute_nondetect.html">impute_nondetect</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">data</span>,</span>
<span>  dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"lognormal"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="working-with-different-column-names">Working with Different Column Names<a class="anchor" aria-label="anchor" href="#working-with-different-column-names"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify custom column names</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">impute_tobit_random</span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">data</span>,</span>
<span>  value_col <span class="op">=</span> <span class="st">"measurement"</span>,</span>
<span>  cens_col <span class="op">=</span> <span class="st">"is_below_loq"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use this package in your research, please cite:</p>
<pre><code>Pereira L, Infante P, Ferreira T, Quaresma P (2025). survlab: Survival Model-Based Imputation for Laboratory Non-Detect Data. R package version 0.1.0.</code></pre>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing survlab</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Luís Pereira <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0628-4847" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Paulo Infante <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1644-9502" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Teresa Ferreira <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-3900-1460" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Paulo Quaresma <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5086-059X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luís Pereira, Paulo Infante, Teresa Ferreira, Paulo Quaresma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
