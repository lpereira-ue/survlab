<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Survival Model-Based Imputation for Laboratory Non-Detect Data • survlab</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Survival Model-Based Imputation for Laboratory Non-Detect Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">survlab</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lpereira-ue/survlab"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Survival Model-Based Imputation for Laboratory Non-Detect Data</h1>
                        <h4 data-toc-skip class="author">survlab
package</h4>
            
            <h4 data-toc-skip class="date">2025-12-06</h4>
      

      <div class="d-none name"><code>package_vignette.rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>survlab</code> package provides tools for imputing
non-detect values in environmental laboratory data using survival models
(including Tobit models). This is particularly useful for environmental
engineers, consultants, and laboratory professionals working with
analytical data where measurements fall below detection limits or limits
of quantification (LOQ).</p>
<p>Non-detect values are common in environmental monitoring programs,
contamination assessments, and regulatory compliance testing.
Traditional approaches like substitution with half the detection limit
can introduce bias and affect statistical analyses.</p>
<p>The package automatically: - Selects the best-fitting distribution
from multiple options - Generates realistic imputed values below their
respective detection limits - Ensures all imputed values are unique and
properly constrained - Provides validation and diagnostic tools
specifically designed for laboratory data</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub (once published)</span></span>
<span><span class="co"># devtools::install_github("yourusername/survlab")</span></span>
<span></span>
<span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">survlab</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">survlab</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="section level3">
<h3 id="load-example-data">Load Example Data<a class="anchor" aria-label="anchor" href="#load-example-data"></a>
</h3>
<p>The package includes a synthetic environmental laboratory dataset
with non-detect values:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">multi_censored_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Explore the dataset</span></span>
<span><span class="va">multi_censored_data</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  total_samples <span class="op">=</span> <span class="va">.N</span>,</span>
<span>  non_detects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  detects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  min_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>  max_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;    total_samples non_detects detects min_value max_value</span></span>
<span><span class="co">#&gt;            &lt;int&gt;       &lt;int&gt;   &lt;int&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           200          33     167         5  61.62913</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the different detection limit levels</span></span>
<span><span class="va">detection_limits</span> <span class="op">&lt;-</span> <span class="va">multi_censored_data</span><span class="op">[</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Detection limit levels:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">detection_limits</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Detection limit levels: 5, 8, 15, 25</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="perform-imputation">Perform Imputation<a class="anchor" aria-label="anchor" href="#perform-imputation"></a>
</h3>
<p>The main function <code><a href="../reference/impute_nondetect.html">impute_nondetect()</a></code> automatically
validates data quality, selects the best distribution, and generates
imputed values:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform imputation with parameter validation</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_nondetect.html">impute_nondetect</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">multi_censored_data</span>,</span>
<span>  value_col <span class="op">=</span> <span class="st">"value"</span>, </span>
<span>  cens_col <span class="op">=</span> <span class="st">"censored"</span>,</span>
<span>  parameter_col <span class="op">=</span> <span class="st">"parameter"</span>,</span>
<span>  unit_col <span class="op">=</span> <span class="st">"unit"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="validate-results">Validate Results<a class="anchor" aria-label="anchor" href="#validate-results"></a>
</h3>
<p>Use the validation function to check imputation quality:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Validate the imputation</span></span>
<span><span class="fu"><a href="../reference/validate_imputation.html">validate_imputation</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;      loq count min_imputed max_imputed mean_imputed</span></span>
<span><span class="co">#&gt;    &lt;num&gt; &lt;int&gt;       &lt;num&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     5    10    3.130343    4.954098     4.411970</span></span>
<span><span class="co">#&gt; 2:     8     8    1.777147    7.443072     5.988641</span></span>
<span><span class="co">#&gt; 3:    15    12    5.440542   14.849822     9.342475</span></span>
<span><span class="co">#&gt; 4:    25     3    5.464246   16.266220    10.072552</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="examine-results">Examine Results<a class="anchor" aria-label="anchor" href="#examine-results"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Look at the first 10 non-detect observations</span></span>
<span><span class="va">result</span><span class="op">[</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  original_detection_limit <span class="op">=</span> <span class="va">value</span>,</span>
<span>  imputed_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value_imputed</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  final_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value_final</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;     original_detection_limit imputed_value final_value</span></span>
<span><span class="co">#&gt;                        &lt;num&gt;         &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:                       25        8.4872      8.4872</span></span>
<span><span class="co">#&gt;  2:                       15       10.3007     10.3007</span></span>
<span><span class="co">#&gt;  3:                        5        4.9371      4.9371</span></span>
<span><span class="co">#&gt;  4:                        5        4.7981      4.7981</span></span>
<span><span class="co">#&gt;  5:                        5        4.4084      4.4084</span></span>
<span><span class="co">#&gt;  6:                        5        4.2841      4.2841</span></span>
<span><span class="co">#&gt;  7:                       25       16.2662     16.2662</span></span>
<span><span class="co">#&gt;  8:                        5        4.6366      4.6366</span></span>
<span><span class="co">#&gt;  9:                        8        6.3738      6.3738</span></span>
<span><span class="co">#&gt; 10:                        5        4.1271      4.1271</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>You can create plots to visualize the imputation results:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="va">result</span><span class="op">[</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu">.</span><span class="op">(</span>value <span class="op">=</span> <span class="va">value</span>, type <span class="op">=</span> <span class="st">"Detected"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="va">result</span><span class="op">[</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu">.</span><span class="op">(</span>value <span class="op">=</span> <span class="va">value_imputed</span>, type <span class="op">=</span> <span class="st">"Imputed"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create histogram</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span>, bins <span class="op">=</span> <span class="fl">30</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"max_detection_limit"</span><span class="op">)</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution Comparison: Detected vs Imputed Values"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Red line shows maximum detection limit ="</span>, </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"max_detection_limit"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Value"</span>, y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Detected"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Imputed"</span> <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="package_vignette_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Q-Q plot to check distribution fit</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="va">censored</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">value_imputed</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Q-Q Plot of Imputed Values"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected distribution:"</span>, </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"best_distribution"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="package_vignette_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level2">
<h2 id="advanced-usage">Advanced Usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h2>
<div class="section level3">
<h3 id="custom-distribution-selection">Custom Distribution Selection<a class="anchor" aria-label="anchor" href="#custom-distribution-selection"></a>
</h3>
<p>You can specify which distributions to test and adjust validation
thresholds:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test only specific distributions with custom validation</span></span>
<span><span class="va">result_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_nondetect.html">impute_nondetect</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">multi_censored_data</span>,</span>
<span>  dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"lognormal"</span>, <span class="st">"weibull"</span><span class="op">)</span>,</span>
<span>  min_observations <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  max_censored_pct <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-information">Model Information<a class="anchor" aria-label="anchor" href="#model-information"></a>
</h3>
<p>The function returns useful model information as attributes:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract model information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best distribution:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"best_distribution"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best distribution: lognormal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Model AIC:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"aic"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model AIC: 1220.47</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Parameter:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"parameter"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameter: Nitrate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Unit:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"unit"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: mg/l NO3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sample size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"sample_size"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample size: 200</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Censoring percentage:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"censored_pct"</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Censoring percentage: 16.5 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Detection limits found:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"detection_limits"</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Detection limits found: 25, 15, 5, 8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Maximum detection limit:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"max_detection_limit"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum detection limit: 25</span></span>
<span></span>
<span><span class="co"># Access the fitted model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"best_model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; survival::survreg(formula = survival::Surv(x, cens, type = "left") ~ </span></span>
<span><span class="co">#&gt;     1, dist = d)</span></span>
<span><span class="co">#&gt;               Value Std. Error    z      p</span></span>
<span><span class="co">#&gt; (Intercept)  2.4672     0.0429 57.6 &lt;2e-16</span></span>
<span><span class="co">#&gt; Log(scale)  -0.5339     0.0556 -9.6 &lt;2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scale= 0.586 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log Normal distribution</span></span>
<span><span class="co">#&gt; Loglik(model)= -608.2   Loglik(intercept only)= -608.2</span></span>
<span><span class="co">#&gt; Number of Newton-Raphson Iterations: 6 </span></span>
<span><span class="co">#&gt; n= 200</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="understanding-the-data-structure">Understanding the Data Structure<a class="anchor" aria-label="anchor" href="#understanding-the-data-structure"></a>
</h2>
<p>The package expects laboratory data with a specific structure:</p>
<ul>
<li>
<strong>value_col</strong>: Contains either detected values (for
samples above detection limit) or detection limit values (for non-detect
samples)</li>
<li>
<strong>cens_col</strong>: Binary indicator where 0 = non-detect
(below detection limit), 1 = detected (above detection limit)</li>
</ul>
<p>For non-detect observations, the value in <code>value_col</code> is
treated as the detection limit for that specific analysis, allowing for
different detection limits across samples or analytical methods.</p>
</div>
<div class="section level2">
<h2 id="tips-for-real-laboratory-data">Tips for Real Laboratory Data<a class="anchor" aria-label="anchor" href="#tips-for-real-laboratory-data"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<strong>Multiple Detection Limits</strong>: The package handles data
with different detection limits automatically</li>
<li>
<strong>Distribution Selection</strong>: Let the function test
multiple distributions for best fit</li>
<li>
<strong>Validation</strong>: Always run
<code><a href="../reference/validate_imputation.html">validate_imputation()</a></code> to check results</li>
<li>
<strong>Seed Setting</strong>: Use <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> for
reproducible results in reports</li>
<li>
<strong>Large Datasets</strong>: The package uses
<code>data.table</code> for efficient memory usage</li>
<li>
<strong>Environmental Data</strong>: Works well with typical
environmental contaminant distributions (often lognormal)</li>
</ol>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>survlab</code> package provides a robust solution for
imputing non-detect values in environmental laboratory data using
survival models. The automatic distribution selection and built-in
validation ensure reliable results for environmental monitoring,
contamination assessment, and regulatory compliance applications.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luís Pereira, Paulo Infante, Teresa Ferreira, Paulo Quaresma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
